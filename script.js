import{myDictionary as e}from"./dictionary.js";var type_audio=new Audio("../audio/select.mp3"),bell_audio=new Audio("../audio/bell.mp3"),bell4_audio=new Audio("../audio/bell4.mp3"),cong_audio=new Audio("../audio/cong.mp3");type_audio.load(),bell_audio.load(),cong_audio.load();var keyboard=new Map([["q",0],["w",0],["e",0],["r",0],["t",0],["y",0],["u",0],["i",0],["o",0],["p",0],["a",0],["s",0],["d",0],["f",0],["g",0],["h",0],["j",0],["k",0],["l",0],["z",0],["x",0],["c",0],["v",0],["b",0],["n",0],["m",0]]);function getSecretWord(){for(var t="crane";;){t=e[Math.floor(Math.random()*e.length)],console.log(t);let o=new Set;for(let r=0;r<5;++r)o.add(t[r]);if(5==o.size)return t}}let state={secret:getSecretWord(),grid:Array(6).fill().map(()=>[,,,,,].fill("")),currentRow:0,currentCol:0,greenpoints:0,yellowpoints:0,hinted:0,scored:0,score:0};function drawGrid(e){let t=document.createElement("div");t.className="grid";for(let o=0;o<6;o++)for(let r=0;r<5;r++)drawBox(t,o,r);e.appendChild(t)}function updateGrid(){for(let e=0;e<state.grid.length;e++)for(let t=0;t<state.grid[e].length;t++){let o=document.getElementById(`box${e}${t}`);o.textContent=state.grid[e][t]}}function drawBox(e,t,o,r=""){let n=document.createElement("div");return n.className="box",n.id=`box${t}${o}`,n.textContent=r,e.appendChild(n),n}function getScore(){let e=state.currentRow,t=state.greenpoints,o=state.yellowpoints,r;return(2*(10*(7-e)+2*t+o-20)/(1+state.hinted)).toFixed()}function registerKeyboardEvents(){document.body.onkeydown=e=>{let t=e.key;if("Enter"===t&&(1==state.scored&&window.location.reload(),5===state.currentCol)){let o=getCurrentWord();isWordValid(o)?(revealWord(o),state.currentRow++,state.currentCol=0):alert("Invalid word")}("Backspace"===t||"Delete"===t)&&removeLetter(),isLetter(t)&&addLetter(t),updateGrid()}}function getCurrentWord(){return state.grid[state.currentRow].reduce((e,t)=>e+t)}function isWordValid(t){return e.includes(t)}function revealWord(e){let t=state.currentRow;for(let o=0;o<5;o++){let r=document.getElementById(`box${t}${o}`),n=r.textContent;setTimeout(()=>{n===state.secret[o]?(state.greenpoints++,keyboard.set(n,1),r.classList.add("right"),changeLetter(n.toUpperCase(),"green")):state.secret.includes(n)?(1!=keyboard.get(n)&&(state.yellowpoints++,keyboard.set(n,2),changeLetter(n.toUpperCase(),"yellow")),r.classList.add("wrong")):(keyboard.set(n,3),r.classList.add("empty"),changeLetter(n.toUpperCase(),"gray"))},(o+1)*500/2),state.secret==e?r.classList.add("jiggle"):r.classList.add("animated"),r.style.animationDelay=`${500*o/2}ms`}let a=state.secret===e,i=5===state.currentRow;setTimeout(()=>{if(a){var e=getScore();cong_audio.play(),alert(`CONGRATULATIONS! 
 Your score : ${e}`),state.scored=1,setTimeout(()=>{window.location.reload()},5e3)}else i&&(alert(`The word was ${state.secret.toUpperCase()}`),window.location.reload())},2500)}function isLetter(e){return 1===e.length&&e.match(/[a-z]/i)}function addLetter(e){5!==state.currentCol&&(state.grid[state.currentRow][state.currentCol]=e,state.currentCol++)}function removeLetter(){0!==state.currentCol&&(state.grid[state.currentRow][state.currentCol-1]="",state.currentCol--)}function changeLetter(e,t){let o=document.getElementById(e);o.style.backgroundColor=t,o.style.borderColor=t}var meaningHint="Sorry, Hint not found!";function getMeaning(e){fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${e}`).then(e=>e.json()).then(e=>{meaningHint=e[0].meanings[0].definitions[0].definition}).catch(()=>{console.log("sorry can not find")})}function startup(){let e=$("#game")[0];drawGrid(e);let t=$("#kboard1")[0],o=$("#kboard2")[0],r=$("#kboard3")[0],n=$("#kboard4")[0],a=["Q","W","E","R","T","Y","U","I","O","P","A","S","D","F","G","H","J","K","L","Z","X","C","V","B","N","M","✂","ENTER","HINT","CLEAR"];for(let i=0;i<30;i++){let l=a[i],s=document.createElement("button"),d=document.createElement("span");d.style.fontSize="20px",d.style.fontWeight="600",d.appendChild(document.createTextNode(l)),s.appendChild(d),i<10?t.appendChild(s):i<19?o.appendChild(s):i<27?r.appendChild(s):n.appendChild(s),s.setAttribute("id",l),s.classList.add("keybutton"),"✂"==l?(s.style.width="35px",s.style.color="blue",s.onclick=function(){if(bell_audio.play(),state.currentRow>=5){state.hinted++;let e=keyboard;for(let t=0;t<5;t++)e.set(state.secret[t],5);let o="abcdefghijklmnopqrstuvwxyz";for(let r=0;r<26;r++)0==e.get(o[r])&&(document.getElementById(o[r].toUpperCase()).style.opacity="0.1")}else swal("OOPS!","Scissor will be activated in last trial","error")}):"ENTER"==l?(s.style.color="green",s.style.width="88px",s.onclick=function(){c(l)}):"CLEAR"==l?(s.style.color="red",s.style.width="88px",s.onclick=function(){c(l)}):"HINT"==l?(s.style.width="71px",s.style.color="blue",s.onclick=function(){state.currentRow>=2?(bell4_audio.play(),state.hinted++,swal("HINT",meaningHint,"success")):(bell_audio.play(),navigator.vibrate(200),swal("OOPS!","Hint will be activated after 2nd trial","error"))}):(s.style.width="35px",s.onclick=function(){c(l)})}function c(e){type_audio.play();let t=document.getElementById(e).textContent;if("enter"===(t=t.toLowerCase())&&(1==state.scored&&window.location.reload(),5===state.currentCol)){let o=getCurrentWord();isWordValid(o)?(revealWord(o),state.currentRow++,state.currentCol=0):alert("Invalid word")}"clear"===t&&removeLetter(),isLetter(t)&&addLetter(t),updateGrid()}registerKeyboardEvents(),console.log(state.secret),$("h2").on("mouseover",function(){$("h2").css("opacity","0.9")}),$("button").on("mouseover",function(){$("button").css("opacity","1")}),$("button").on("mouseleave",function(){$("button").css("opacity","0.9")}),$("h2").on("mouseleave",function(){$("h2").css("opacity","0.5")}),$("h2").on("click",function(){window.open("../images/manual.png","popUpWindow","height=595,width=600,left=300,top=100,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no, status=yes")})}getMeaning(state.secret),startup();
